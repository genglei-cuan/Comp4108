Reading Analysis of On the Effectiveness of Address-Space Randomization

The paper, On the Effectiveness of Address-Space Randomization by Shacham et al. was a paper published in CCS '04 Proceedings of the 11th ACM conference on Computer and communications security that highlighted that buffer overflow attacks on programs utilizing address space layout randomization were trivial on 32 bit systems. The authors show that their buffer overflow attack takes on average 216 seconds to compromise a vulnerable Apache web server. Their attack consisted of a return-to-libc method of exploitation which would linearly guess the address of the system() function call. Once the address of the system() call was found, the exploit would use the system() system call to start a reverse shell, giving the hacker remote access to the server with the privileges of the Apache web server user.

Discussed in this paper is a method of mitigating buffer overflow attacks by use of address space layout randomization. Address space layout randomization comes in many forms. At the program's compile-time, function addresses, function parameter orders and memory page order are randomized. This prevents an attacker from knowing the value of or offset of the address of a function or location in memory since the locations of the function addresses, function parameter order and memory page orders are randomized at compile time of the program. This randomization adds 2^16 times the search space to find the system() function's address. One downside to this comile-time method of address space layout randomization is that once the attacker obtains the address of a function or variable, they can use this knowledge for the entirety of that program's usage. Restarting the program won't help. The only thing that can stop the attacker after they know it is to recompile the program to randomize the addresses a different way.

Another method of performing address space layout randomization is at program runtime. During the program's start the runtime randomly chooses a location in memory for the stack, heap, text and shared libraries. Each time the attacker tries to guess the address of the system() function, if unsuccessful, the program will segfault and in Apache's case, restart. Upon program restart, the program randomizes it's memory addresses to completely new random values. This mitigation method only increases the time it takes for the attacker to perform a successful buffer overflow attack. The authors have determined that runtime based address space layout randomization only adds one extra bit of complexity to searching for the system() function address, resulting in 2^17 bits of complexity.

Since address space layout randomization was used, it made it harder for an attacker to compromise the system. The attacker faces even more issues when the system has a 64 bit architecture since the possible virtual address space is magnitudes larger than a 32 bit architecture system. The authors say that their attack is infeasible when it comes to 64 bit systems because of the aforementioned reason. Other mitigation methods of buffer overflow attacks are StackGuard, ProPolice and PointGuard. These three methods are considered "orthogonal" mitigations of address space layout randomization since they try to solve the same problem, but from different directions.

Overall I found that the paper was interesting in that it presented original ideas about compile-time and run-time address space layout randomization. I found that some of the runtime based address space layout randomization solutions discussed in section 3.3.2 were hard to understand as it required understanding how shared libraries worked in an operating system and relative references of functions in shared libraries. What surprised me was that run-time address space layout randomization was only 2 times better than compile-time randomization. I believe that address space layout randomization is providing a much greater use in 2016 than in 2004, when this paper was written, because more systems these days are using 64 bit architectures. With 64 bit architectures, address space layout randomization has many more bits to use for randomizing addresses in virtual memory.
